---
tags:
  - 1С
---
При оптимизации клиент-серверного взаимодействия разработчик должен учитывать, что в некоторых клиентских обработчиках событий формы (`ПередЗаписью()`, `ПослеЗаписи()`, `ПередЗакрытием()`, `ПриЗакрытии()` и др.) запрещается вызывать контекстные серверные процедуры.

При описании таких событий в синтакс-помощнике содержится специальное указание на запрещенное действие или описание действия, которое может привести к недопустимому вызову:
- В обработчике данного события нельзя использовать серверные методы формы с директивой компиляции `&НаСервере`.
- Изменение свойства на клиенте может потребовать обращения к серверу.
- Вызов метода выполняет обращение к серверу.

Последние два предупреждения означают, что использование указанных клиентских методов или изменение некоторых свойств на клиенте могут приводить к неявным серверным вызовам. Поэтому разработчик не может применять их в обработчике события, для которого запрещены контекстные серверные вызовы.

Дело в том, что подобные вызовы потенциально могут нарушить алгоритмы функционирования форм. Поэтому они запрещены на уровне платформы, в процессе исполнения прикладного кода в режиме 1С:Предприятие. Но в процессе написания кода разработчик может допустить такую ошибку. И для того, чтобы обнаружить такую ошибку заранее (а не в режиме исполнения), существует эта проверка.

При автоматическом создании клиентского обработчика события, в котором запрещены контекстные серверные вызовы, в окне выбора типа обработчика (на клиенте, на сервере без контекста или на сервере) последняя опция (вызов с клиента контекстной серверной процедуры) будет недоступна для выбора. В принципе, разработчик может проигнорировать это предупреждение и написать «руками» тот вызов, который ему требуется. Но, тогда ответственность за возможные ошибки в работе приложения будет лежать целиком на нем.

Диагностику нарушений вышеуказанных ограничений можно включить в параметрах конфигуратора. Для этого нужно выполнить команду главного меню ==Сервис – Параметры – Запуск 1С:Предприятия – Дополнительные== и установить флажок Проверять серверные вызовы в обработчиках событий (рис. 4.12).

![[Pasted image 20240731125202.png|600]]

Режим проверки использования контекстных серверных вызовов формы в обработчиках событий также можно включить, запустив «1С:Предприятие» из командной строки с параметром `/EnableCheckServerCalls`.

При этом, если во время исполнения прикладного решения выполняется контекстный серверный вызов в обработчике события формы, в котором такие вызовы запрещены, в окно сообщений будет выведено диагностическое сообщение. Это же сообщение будет доступно в окне информации о программе по ссылке Информация для технической поддержки (рис. 4.13).

![[Pasted image 20240731125822.png|600]]
